<html>
<head>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<style>
	/*
                                                     * Specific styles of signin component
                                                     */
                                                    /*
                                                     * General styles
                                                     */
                                                    body, html {
                                                        height: 100%;
                                                        background-repeat: no-repeat;
                                                        background-image: linear-gradient(rgb(104, 145, 162), rgb(12, 97, 33));
                                                    }

                                                    .card-container.card {
                                                        max-width: 350px;
                                                        padding: 40px 40px;
                                                    }

                                                    .btn {
                                                        font-weight: 700;
                                                        height: 36px;
                                                        -moz-user-select: none;
                                                        -webkit-user-select: none;
                                                        user-select: none;
                                                        cursor: default;
                                                    }

                                                    /*
                                                     * Card component
                                                     */
                                                    .card {
                                                        background-color: #F7F7F7;
                                                        /* just in case there no content*/
                                                        padding: 20px 25px 30px;
                                                        margin: 0 auto 25px;
                                                        margin-top: 50px;
                                                        /* shadows and rounded borders */
                                                        -moz-border-radius: 2px;
                                                        -webkit-border-radius: 2px;
                                                        border-radius: 2px;
                                                        -moz-box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);
                                                        -webkit-box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);
                                                        box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);
                                                    }

                                                    .profile-img-card {
                                                        width: 96px;
                                                        height: 96px;
                                                        margin: 0 auto 10px;
                                                        display: block;
                                                        -moz-border-radius: 50%;
                                                        -webkit-border-radius: 50%;
                                                        border-radius: 50%;
                                                    }

                                                    /*
                                                     * Form styles
                                                     */
                                                    .profile-name-card {
                                                        font-size: 16px;
                                                        font-weight: bold;
                                                        text-align: center;
                                                        margin: 10px 0 0;
                                                        min-height: 1em;
                                                    }

                                                    .reauth-email {
                                                        display: block;
                                                        color: #404040;
                                                        line-height: 2;
                                                        margin-bottom: 10px;
                                                        font-size: 14px;
                                                        text-align: center;
                                                        overflow: hidden;
                                                        text-overflow: ellipsis;
                                                        white-space: nowrap;
                                                        -moz-box-sizing: border-box;
                                                        -webkit-box-sizing: border-box;
                                                        box-sizing: border-box;
                                                    }

                                                    #inputEmail,
                                                    #inputPassword,#inputEmail1,
                                                    #inputPassword1,#confirmPassword1{
                                                        direction: ltr;
                                                        height: 44px;
                                                        font-size: 16px;
                                                    }

                                                    input[type=email],
                                                   input[type=password],
                                                    input[type=text],
                                                     button {
                                                        width: 100%;
                                                        display: block;
                                                        margin-bottom: 10px;
                                                        z-index: 1;
                                                        position: relative;
                                                        -moz-box-sizing: border-box;
                                                        -webkit-box-sizing: border-box;
                                                        box-sizing: border-box;
                                                    }

                                                     .form-control:focus {
                                                        border-color: rgb(104, 145, 162);
                                                        outline: 0;
                                                        -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgb(104, 145, 162);
                                                        box-shadow: inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgb(104, 145, 162);
                                                    }

                                                    .btn.btn-signin {
                                                        /*background-color: #4d90fe; */
                                                        background-color: rgb(104, 145, 162);
                                                        /* background-color: linear-gradient(rgb(104, 145, 162), rgb(12, 97, 33));*/
                                                        padding: 0px;
                                                        font-weight: 700;
                                                        font-size: 14px;
                                                        height: 36px;
                                                        -moz-border-radius: 3px;
                                                        -webkit-border-radius: 3px;
                                                        border-radius: 3px;
                                                        border: none;
                                                        -o-transition: all 0.218s;
                                                        -moz-transition: all 0.218s;
                                                        -webkit-transition: all 0.218s;
                                                        transition: all 0.218s;
                                                    }

                                                    .btn.btn-signin:hover,
                                                    .btn.btn-signin:active,
                                                    .btn.btn-signin:focus {
                                                        background-color: rgb(12, 97, 33);
                                                    }

                                                    .forgot-password {
                                                        color: rgb(104, 145, 162);
                                                    }

                                                    .forgot-password:hover,
                                                    .forgot-password:active,
                                                    .forgot-password:focus{
                                                        color: rgb(12, 97, 33);
                                                    }
	</style>
</head>
<body>
	<div class="mainContainer"></div>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.2/underscore-min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.0.0/backbone-min.js"></script>
	<script type="text/javascript">

		var BlogsView = Backbone.View.extend({
							el: ".mainContainer",
              token:null,
							signUptemplate: _.template('<div class="container"><div class="card card-container"><p id="profile-name" class="profile-name-card"></p><span id="reauth-email" class="reauth-email"></span><input type="email" id="inputEmail" class="form-control" placeholder="Email address" required autofocus><input type="password" id="inputPassword" class="form-control" placeholder="Password" required><button class="btn btn-lg btn-primary btn-block btn-signin" id="loginId" type="submit">Log in</button><button class="btn btn-lg btn-primary btn-block" id="signUp">Sign up</button></div></div>'),
							loginTemplate:_.template('<div class="container"><div class="card card-container"><img id="profile-img" class="profile-img-card" src="//ssl.gstatic.com/accounts/ui/avatar_2x.png" /><p id="profile-name" class="profile-name-card"></p><span id="reauth-email" class="reauth-email"></span><input type="email" id="inputEmail1" class="form-control" placeholder="Email address" required autofocus><input type="password" id="inputPassword1" class="form-control" placeholder="Password" required><input type="password" id="confirmPassword1" class="form-control" placeholder=" Confirm Password" required><button class="btn btn-lg btn-primary btn-block btn-signin" type="submit" id="submitSignup">Sign Up</button></div></div>'),
							reminderHomepageTemplate:_.template('<div class="row" style="height:100%;margin: 5%"><div class="row" style="height:50px;widht:100%;"><div class="col-md-12" style="height:100%;background-color:#333"> <span style="float:right;color:white;margin-top: 1%;" id="userId"> gitanjali@gmail.com</span></div></div><div class="row" style="height:calc(100% - 100px);widht:100%;margin:0px"><div class="row" style="height:10px"> <h3>Add Reminder</h3></div><div class="row" style="height:5%;margin-top: 5%;margin-left: -3%;"><div class="col-md-6"><input type="text" id="reminderId" placeholder="Add Reminder Message"/></div><div class="col-md-2"><input type="text"  id="phnId"  placeholder="Phone Number"/></div><span><div class="col-md-3 input-group date" id="datetimepicker1"><input  class="form-control" id="dateId" type="text" placeholder="Date and Time"/><span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span></div></span><div class="col-md-1"><button id="addReminder" style="display:inline">Add</button></div></div><div class="row" style="height:10px"> <h3>Upcoming Reminders</h3></div><div class="row" style="height:35%" id="upcomingReminder"></div><div class="row" style="height:10px"><h3> Past Reminders</h3></div><div class="row" style="height:35%" id="pastReminder"></div></div></div>'),
							initialize: function() {
								var self = this;
							   this.$el.html(self.signUptemplate());
							   this.render();
								
							},
							events:{
											'click #signUp':'SignUpFun',
											'click #loginId':'loginFun',
                                            'click #addReminder':'addReminderFun',
											'click #submitSignup':'submitSignupFun'
							},
							SignUpFun:function(){
								var self=this;
									this.$el.html(self.loginTemplate());
							},
                            addReminderFun:function(){
                                var self=this;
                                console.log(self.token)
                                    var reminder=document.getElementById('reminderId').value,
                                         phn=document.getElementById('phnId').value,
                                         date=document.getElementById('dateId').value,
                                         //reminderArray={"scheduled_datetime": date,"message": reminder,"phone_number": phn};
reminderArray={
  "scheduled_datetime": "2016-08-27T14:24:00Z",
  "message": "this is a test message",
  "phone_number": "1234567890"
};
var tokenValue="Token {"+self.token+"}";
                                            $.ajax({
                                              type: "POST",
                                              url: "http://localhost:3000/reminders/",
                                              data: reminderArray,
                                              dataType: 'json',
                                              beforeSend: function (xhr) {
                                                    /* Authorization header */
                                                     xhr.setRequestHeader ("Authorization", "'"+tokenValue+"'");
                                                },
                                              success: function(response){
                                                //self.$el.html(self.reminderHomepageTemplate());
                                                console.log(response);
                                              },
                                              error:function(err){
                                                //alert("SignUp Failed!")
                                                //console.log(err);
                                              }
                                            });

                            },
							loginFun:function(){

								var self=this;

								var email=document.getElementById('inputEmail').value,
									password=document.getElementById('inputPassword').value,
									loginData={"username": email,"password": password};
									if(email && password){
										$.ajax({
											  type: "POST",
											  url: "http://localhost:3000/rest-auth/login/",
											  data: loginData,
											  dataType: 'json',
											  success: function(response){
											  	console.log(response.key);
                          self.token=response.key;
											  	self.$el.html(self.reminderHomepageTemplate());
                                                         //        $.ajax({
                                                         //   url: "http://localhost:3000/reminders",
                                                         //   type: "GET",
                                                         //   success: function(response){
                                                         //     console.log(response);
                                                         //     $('#upcomingReminder').html(response);
                                                         //   },
                                                         //   error:function(){
                                                         //    console.log("err");
                                                         //   }
                                                         // });
											  },
											  error:function(err){
											  	alert("SignUp First!")
											  	//console.log(err);
											  }
											});

									}
                                    else{
                                        alert("Enter Valid Details")
                                    }
								
							},
							submitSignupFun:function(){
								var self=this;
								var email=document.getElementById('inputEmail1').value,
								    password=document.getElementById('inputPassword1').value,
							        confirm_password=document.getElementById('confirmPassword1').value,
							        signUpData={"email": email,"password": password,"confirm_password": confirm_password};
								if(password===confirm_password){
												$.ajax({
											  type: "POST",
											  url: "http://localhost:3000/register/",
											  data: signUpData,
											  dataType: 'json',
											  success: function(response){
											  	self.$el.html(self.reminderHomepageTemplate());
											  	//console.log(response);
											  },
											  error:function(err){
											  	alert("SignUp Failed!")
											  	console.log(err);
											  }
											});
								}
								else
								{
									alert("Password Mismatch!");
									self.resetForm();
								}
								
							},
							resetForm:function(){
								 //document.getElementById('inputEmail1').value='',
								 document.getElementById('inputPassword1').value='',
							     document.getElementById('confirmPassword1').value='';
							},
							render: function() {
								var self = this;
								return this;
							}
     });

       var blogsView = new BlogsView();

	</script>


</body>
</html>



<!-- 
<div class="row" style="height:100%;"><div class="row" style="height:50px;widht:100%;margin:0px"><div class="col-md-6" style="height:100%"> <span> gitanjali@gmail.com</span></div></div><div class="row" style="height:calc(100% - 100px);widht:100%;margin:0px"><div class="row" style="height:10px"> Add reminder</div><div class="row" style="height:20%"><div class="col-md-6"><input type="text" placeholder="Add Reminder Message"/></div><div class="col-md-2"><input type="text" placeholder="Phone Number"/></div><div class="col-md-3"><input type="text" placeholder="Date and Time"/></div><div class="col-md-1"></div></div><div class="row" style="height:10px"> Upcoming Reminders</div><div class="row" style="height:35%" id="upcomingReminder"></div><div class="row" style="height:10px"> Past Reminders</div><div class="row" style="height:35%" id="pastReminder"></div></div></div>
 -->





